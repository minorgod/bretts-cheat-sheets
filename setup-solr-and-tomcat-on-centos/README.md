# Install SOLR 4 and Tomcat 6 on CentOS

Keep in mind, these instructions are very outdated now and reference versions of software that was current at the time. Much of this info is still useful, but I wouldn't recommend using Tomcat6 / Solr4 or CentOS 6. When I wrote these instructions circa 2013, SOLR 4.1 had just been released. As of today, the current stable version is 8.2 and a lot has changed. It's probably a lot easier to set this up now (Spring Boot has a [SOLR starter project](https://spring.io/projects/spring-data-solr) that can jumpstart a project really quickly if you're using Spring Boot already), but this doc will still probably be helpful so I'm keeping these instructions for reference in case I need to set up SOLR from scratch again.  

## Overview 

Why was this necessary? Who even needs a dedicated search server anyway?

Between 2010 and 2014, I was the lead web developer for heels.com, a women's shoe retailer that grew to have peak traffic on the site of around 2000 simultaneous users with sales as high as $10,000/hr during the peak shopping season. It had a fantastic visual search UI with a "faceted search" interface for an inventory of over 200,000 SKUs. There was a full-text search box for typical keyword searches, plus users could select dozens of attributes to filter the entire inventory with or without search keywords. Despite being powerful, it was very easy to use. Just click any attribute in a dropdown menu and the UI "instantly" updated without a page refresh (and we did this the hard way with jQuery and manual browser history manipulation...yuck!). Users  could filter results simultaneously by size, color, category, style, brand, heel height, persona, availability, on-sale, occasion, etc. Anyone who has had to solve this sort of problem will tell you, this is a clusterfuck to do with MySQL queries. The backend code was ugly, performance was awful and matching synonyms or misspellings was nearly impossible to do reliably. As users would select more and more attributes on the frontend, queries were "ANDed" together on the backend, and shoe attributes that were stored in different tables resulted in increasing numbers of INNER JOINs. With over 200,000 skus in the DB queries were taking 20+ seconds to return results with only a few filters selected, and beyond 3 or 4 filters the DB server would start grinding to a halt. This was not acceptable, so I was tasked with finding a solution. I researched available options, starting with Apache Lucene, and quickly found Apache SOLR - a search server built on Lucene, but which had solved all the hard problems of actually using Lucene for things that were particularly applicable to ecommerce search problems. Specifically it was great at faceted search, was stable as hell, fast as hell, allowed for serving queries while re-indexing the data source, and it came with a minimal, but very useful admin dashboard. After a few weeks of learning the basics, I was able to set up a prototype for testing and found that the even the nastiest search queries that would take over a minute to return results with our SQL backend, SOLR could do in milliseconds with far more accuracy and flexibility. Results could be weighted by various factors such as product release date, keyword relevance or other indexed attributes, and each attribute could be weighted differently if desired. Newer shoes could easily be pushed to the top of the results, and matches on things like shoe size and brand could be weighted more heavily which was particularly important to women's shoe retail. It worked better than I ever thought it could. Once we rolled the final solution into production, our database load went to near zero and our search was better and faster than our biggest competitors out there - Zappos, Shoes.com and Amazon. Frankly, their sites were a joke compared to heels.com, and our development team at the time basically consisted of just me and 1 other developer. We were super-proud of what we were able to accomplish. 

But enough backstory.  Let's get on with the technical details. 

[install-solr4-and-tomcat6-on-centos6.md](install-solr4-and-tomcat6-on-centos6.md)

